## ----setup, include=FALSE--------------------------------------------------------------
knitr::opts_chunk$set(echo = TRUE)


## --------------------------------------------------------------------------------------
x = c(19,22,24,26)
x


## --------------------------------------------------------------------------------------
x = c(128, 128, 160, 142, 157, 179,
      122, 137, 177, 177, 160, 138,
      207, 188, 181, 164, 155, 175,
      120, 208, 199, 194, 177, 195)
matrix(x, byrow = TRUE, ncol=6)



## --------------------------------------------------------------------------------------
X = matrix(x, nrow = 4)
X


## --------------------------------------------------------------------------------------
wbdata = read.csv("data/worldbank2020.csv")
str(wbdata)


## --------------------------------------------------------------------------------------
with(wbdata, lm(Score ~ GDP.per.capita))


## --------------------------------------------------------------------------------------
x = c(1,2,3,4)
y = c(5,6,7,8)
x + y
x * y


## --------------------------------------------------------------------------------------
(X = matrix(1:6,nrow =3, ncol = 2))
X * X


## --------------------------------------------------------------------------------------
(Y = matrix(1:6, nrow = 2, ncol = 3))
X %*% Y


## --------------------------------------------------------------------------------------
(H = X %*% solve(t(X) %*% X) %*% t(X))


## --------------------------------------------------------------------------------------
y = c(0,1,2)
H %*% y # H times y 
y %*% H # y times H 


## ---- warning=FALSE, message=FALSE-----------------------------------------------------
library(tidyverse)


## --------------------------------------------------------------------------------------
head( select(wbdata, Score) ) 


## --------------------------------------------------------------------------------------
mean(x)


## --------------------------------------------------------------------------------------
x %>% mean


## --------------------------------------------------------------------------------------
wbdata %>% select(Score) %>% head()


## --------------------------------------------------------------------------------------
x = (1:6)^2;block = rep(c("a","b"), each = 3)
(temp.data = data.frame(x,block))
out = temp.data %>% dplyr::group_by(block) %>% dplyr::mutate(ranks = rank(x)) 
out$ranks


## --------------------------------------------------------------------------------------
rankinblock = function(x,block){
  require(dplyr)
  out = data.frame(x,block) %>% group_by(block) %>% mutate(ranks = rank(x))
  return(out$ranks)
}


## --------------------------------------------------------------------------------------
rankinblock(x,block)


## --------------------------------------------------------------------------------------
n = 10
factorial(n)


## --------------------------------------------------------------------------------------
gtools::permutations(n = 4, r = 2, v = 1:4)


## --------------------------------------------------------------------------------------
choose(4,2)


## --------------------------------------------------------------------------------------
gtools::combinations(n = 4, r = 2, v = 1:4)


## --------------------------------------------------------------------------------------
set.seed(1)
x1 = rpois(n = 3, lambda = 5) # n1 = 3
x2 = rpois(n = 2, lambda = 5) # n2 = 2
(x.combined = c(x1,x2))       # n = 5
gtools::combinations(n = 5, r = 3, v = x.combined, set = F)


## --------------------------------------------------------------------------------------
set.seed(1)
sample(x.combined, size = 3)
sample(x.combined, size = 3)
sample(x.combined, size = 5)


## --------------------------------------------------------------------------------------
set.seed(1)
sample(x.combined, size = 3, replace = FALSE) 


## --------------------------------------------------------------------------------------
sample(x.combined, size = 5, replace = TRUE)


## --------------------------------------------------------------------------------------
M = 1999
set.seed(2)
rand.mean = vector(length = M)
for(i in 1:M){
  rand.mean[i] = sample(wbdata$Score, size = 50) %>% mean
}
head(rand.mean)


## --------------------------------------------------------------------------------------
set.seed(2)
rand.mean = replicate(M, sample(wbdata$Score, size = 50) %>% mean)
head(rand.mean)


## --------------------------------------------------------------------------------------
allperms = gtools::combinations(n = 5, r = 3, v = x.combined, set = F)


## --------------------------------------------------------------------------------------
sd.allperms = vector(length = choose(5,3))
for(i in 1:choose(5,3)){
  sd.allperms[i] = allperms[i,] %>% sd()
}
round(sd.allperms,2)


## --------------------------------------------------------------------------------------
apply(allperms, 1, sd) %>% round(2)


## --------------------------------------------------------------------------------------
apply(allperms, 2, 
      function(x){
        cv = sd(x)/mean(x)
        round(cv,2)
      })


## --------------------------------------------------------------------------------------
x = rnorm(100, mean = 1, sd = 1)
data.frame(x = x) %>% 
  ggplot(aes(x = x)) + 
  geom_histogram(aes(y = ..density..), binwidth = .5, fill = "grey", color = "white") +
  geom_rug()


## --------------------------------------------------------------------------------------
data.frame(x = x) %>% 
  ggplot(aes(x = x)) + 
  geom_histogram(aes(y = ..density..), binwidth = .5, fill = "grey", color = "white") +
  geom_function(fun = dnorm, args = list(mean = 1, sd = 1)) 
car::qqPlot(x, dist = "norm", mean = 1, sd = 1)


## --------------------------------------------------------------------------------------
farm = read.csv("data/smartfarm.csv")
farm %>% ggplot(aes(x = block, y = x, color = treatment)) + geom_boxplot()


## --------------------------------------------------------------------------------------
wbdata %>% ggplot(aes(x = GDP.per.capita, y = Score)) + geom_point()


## ---- echo = FALSE---------------------------------------------------------------------
knitr::purl("np_chA_R.Rmd")

